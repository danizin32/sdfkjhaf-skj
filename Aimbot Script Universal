--[[ Script de Teste de Fun√ß√µes - ESP e Aimbot (com minimizar e arrastar)
Criado por ChatGPT a pedido do usu√°rio. Interface escura com bordas vermelhas.
Para fins de testes com autoriza√ß√£o. ]]

local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local TweenService = game:GetService("TweenService")
local Camera = workspace.CurrentCamera
local LocalPlayer = Players.LocalPlayer

-- Configura√ß√µes
local aimbotAtivo = false
local espAtivo = false
local minimized = false

-- GUI
local ScreenGui = Instance.new("ScreenGui", game.CoreGui)
ScreenGui.ResetOnSpawn = false
ScreenGui.Name = "TesteESP_Aimbot_GUI"

local frame = Instance.new("Frame", ScreenGui)
frame.Position = UDim2.new(0, 20, 0.5, -150)
frame.Size = UDim2.new(0, 270, 0, 200)
frame.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
frame.BorderColor3 = Color3.fromRGB(255, 0, 0)
frame.BorderSizePixel = 2
frame.ClipsDescendants = true
frame.Name = "Interface"

local UIListLayout = Instance.new("UIListLayout", frame)
UIListLayout.Padding = UDim.new(0, 4)
UIListLayout.SortOrder = Enum.SortOrder.LayoutOrder

-- T√≠tulo
local titulo = Instance.new("TextLabel", frame)
titulo.Size = UDim2.new(1, -10, 0, 30)
titulo.Position = UDim2.new(0, 5, 0, 0)
titulo.Text = "üî¥ TESTE DE SCRIPT - CHATGPT"
titulo.TextColor3 = Color3.fromRGB(255, 0, 0)
titulo.BackgroundColor3 = Color3.fromRGB(10, 0, 0)
titulo.BorderColor3 = Color3.fromRGB(255, 0, 0)
titulo.Font = Enum.Font.GothamBold
titulo.TextSize = 14
titulo.Name = "Dragger"

-- Fun√ß√£o criar bot√£o
local function criarBotao(texto, callback)
	local btn = Instance.new("TextButton", frame)
	btn.Size = UDim2.new(1, -10, 0, 30)
	btn.Position = UDim2.new(0, 5, 0, 0)
	btn.Text = texto
	btn.TextColor3 = Color3.fromRGB(255, 255, 255)
	btn.BackgroundColor3 = Color3.fromRGB(30, 0, 0)
	btn.BorderColor3 = Color3.fromRGB(255, 0, 0)
	btn.Font = Enum.Font.GothamBold
	btn.TextSize = 14
	btn.AutoButtonColor = false
	btn.MouseButton1Click:Connect(function()
		callback()
		btn.BackgroundColor3 = (btn.BackgroundColor3 == Color3.fromRGB(30, 0, 0)) and Color3.fromRGB(100, 0, 0) or Color3.fromRGB(30, 0, 0)
	end)
end

-- Bot√µes
criarBotao("Ativar ESP", function()
	espAtivo = not espAtivo
end)

criarBotao("Ativar Aimbot", function()
	aimbotAtivo = not aimbotAtivo
end)

-- Cr√©ditos
local creditos = Instance.new("TextLabel", frame)
creditos.Size = UDim2.new(1, -10, 0, 30)
creditos.Text = "Criado por ChatGPT | Testes autorizados"
creditos.TextColor3 = Color3.fromRGB(255, 255, 255)
creditos.BackgroundColor3 = Color3.fromRGB(10, 0, 0)
creditos.BorderColor3 = Color3.fromRGB(255, 0, 0)
creditos.Font = Enum.Font.Gotham
creditos.TextSize = 12

-- Minimizar/Abrir GUI com anima√ß√£o
local toggleBtn = Instance.new("TextButton", ScreenGui)
toggleBtn.Text = "-"
toggleBtn.Size = UDim2.new(0, 30, 0, 30)
toggleBtn.Position = UDim2.new(0, 300, 0.5, -160)
toggleBtn.BackgroundColor3 = Color3.fromRGB(30, 0, 0)
toggleBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
toggleBtn.BorderColor3 = Color3.fromRGB(255, 0, 0)
toggleBtn.Font = Enum.Font.GothamBold
toggleBtn.TextSize = 20
toggleBtn.ZIndex = 5

local tamanhoAberto = UDim2.new(0, 270, 0, frame.AbsoluteContentSize.Y + 10)
local tamanhoFechado = UDim2.new(0, 270, 0, 30)

local function atualizarAltura()
	tamanhoAberto = UDim2.new(0, 270, 0, frame.AbsoluteContentSize.Y + 10)
	if not minimized then
		frame:TweenSize(tamanhoAberto, "Out", "Quad", 0.3, true)
	end
end

UIListLayout:GetPropertyChangedSignal("AbsoluteContentSize"):Connect(atualizarAltura)

local function animarMinimizar()
	minimized = not minimized
	toggleBtn.Text = minimized and "+" or "-"
	local alvo = minimized and tamanhoFechado or tamanhoAberto
	frame:TweenSize(alvo, "Out", "Quad", 0.3, true)
end

toggleBtn.MouseButton1Click:Connect(animarMinimizar)

-- Fun√ß√£o para arrastar a interface
local dragging = false
local dragInput, dragStart, startPos

titulo.InputBegan:Connect(function(input)
	if input.UserInputType == Enum.UserInputType.MouseButton1 then
		dragging = true
		dragStart = input.Position
		startPos = frame.Position
	end
end)

titulo.InputEnded:Connect(function(input)
	if input.UserInputType == Enum.UserInputType.MouseButton1 then
		dragging = false
	end
end)

titulo.InputChanged:Connect(function(input)
	if input.UserInputType == Enum.UserInputType.MouseMovement then
		dragInput = input
	end
end)

game:GetService("UserInputService").InputChanged:Connect(function(input)
	if input == dragInput and dragging then
		local delta = input.Position - dragStart
		frame.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
		toggleBtn.Position = UDim2.new(0, frame.Position.X.Offset + 280, 0, frame.Position.Y.Offset)
	end
end)

-- ESP
local function criarESP(player)
	if player == LocalPlayer then return end
	local box = Instance.new("BoxHandleAdornment")
	box.Name = "ESPBox"
	box.Size = Vector3.new(2, 5, 1)
	box.Color3 = Color3.fromRGB(255, 0, 0)
	box.Transparency = 0
	box.ZIndex = 0
	box.AlwaysOnTop = true
	box.Adornee = player.Character and player.Character:FindFirstChild("HumanoidRootPart")
	box.Parent = player.Character
end

local function removerESP(player)
	if player.Character then
		for _, obj in pairs(player.Character:GetChildren()) do
			if obj:IsA("BoxHandleAdornment") and obj.Name == "ESPBox" then
				obj:Destroy()
			end
		end
	end
end

RunService.RenderStepped:Connect(function()
	for _, player in pairs(Players:GetPlayers()) do
		if player ~= LocalPlayer and player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
			local sameTeam = player.Team == LocalPlayer.Team
			if espAtivo and not sameTeam then
				if not player.Character:FindFirstChild("ESPBox") then
					criarESP(player)
				end
			else
				removerESP(player)
			end
		end
	end
end)

-- Aimbot
RunService.RenderStepped:Connect(function()
	if not aimbotAtivo then return end
	local closest = nil
	local minDist = math.huge
	for _, player in pairs(Players:GetPlayers()) do
		if player ~= LocalPlayer and player.Character and player.Character:FindFirstChild("Head") and player.Team ~= LocalPlayer.Team then
			local headPos, onScreen = Camera:WorldToViewportPoint(player.Character.Head.Position)
			if onScreen then
				local dist = (Vector2.new(headPos.X, headPos.Y) - Vector2.new(Camera.ViewportSize.X/2, Camera.ViewportSize.Y/2)).Magnitude
				if dist < minDist then
					minDist = dist
					closest = player
				end
			end
		end
	end

	if closest and closest.Character and closest.Character:FindFirstChild("Head") then
		Camera.CFrame = CFrame.new(Camera.CFrame.Position, closest.Character.Head.Position)
	end
end)
