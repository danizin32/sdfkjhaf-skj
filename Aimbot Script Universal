-- SE INSCREVAM NO CANAL GALERA!

local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")
local TweenService = game:GetService("TweenService")

local Camera = workspace.CurrentCamera
local LocalPlayer = Players.LocalPlayer

-- CONFIGURAÇÕES
local AimbotEnabled = false
local ESPEnabled = false
local FOV = 100
local TeamCheck = true
local AimPart = "Head"

-- UI PRINCIPAL
local gui = Instance.new("ScreenGui", game.CoreGui)
gui.Name = "TestInterface"

local frame = Instance.new("Frame", gui)
frame.Size = UDim2.new(0, 250, 0, 300)
frame.Position = UDim2.new(0, 20, 0.3, 0)
frame.BackgroundColor3 = Color3.fromRGB(10, 10, 10)
frame.BorderSizePixel = 2
frame.BorderColor3 = Color3.fromRGB(255, 0, 0)
frame.Active = true
frame.Draggable = true

-- MINIMIZAR BOTÃO
local minimized = false
local minButton = Instance.new("TextButton", frame)
minButton.Size = UDim2.new(0, 20, 0, 20)
minButton.Position = UDim2.new(1, -25, 0, 5)
minButton.Text = "-"
minButton.TextColor3 = Color3.new(1, 0, 0)
minButton.BackgroundColor3 = Color3.fromRGB(30, 30, 30)

local contentHolder = Instance.new("Frame", frame)
contentHolder.Size = UDim2.new(1, 0, 1, -30)
contentHolder.Position = UDim2.new(0, 0, 0, 30)
contentHolder.BackgroundTransparency = 1

local function toggleMinimize()
    minimized = not minimized
    local targetSize = minimized and UDim2.new(0, 250, 0, 30) or UDim2.new(0, 250, 0, 300)
    local tween = TweenService:Create(frame, TweenInfo.new(0.3, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), {
        Size = targetSize
    })
    tween:Play()
    contentHolder.Visible = not minimized
end

minButton.MouseButton1Click:Connect(toggleMinimize)

-- BOTÕES
local function createButton(name, callback)
    local btn = Instance.new("TextButton", contentHolder)
    btn.Size = UDim2.new(1, -20, 0, 30)
    btn.Position = UDim2.new(0, 10, 0, (#contentHolder:GetChildren()-1) * 35)
    btn.Text = name
    btn.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
    btn.BorderColor3 = Color3.fromRGB(255, 0, 0)
    btn.TextColor3 = Color3.fromRGB(255, 255, 255)
    btn.MouseButton1Click:Connect(function()
        callback()
        btn.BackgroundColor3 = callback() and Color3.fromRGB(255, 0, 0) or Color3.fromRGB(30, 30, 30)
    end)
    return btn
end

-- FOV CIRCLE
local fovCircle = Drawing.new("Circle")
fovCircle.Color = Color3.fromRGB(255, 0, 0)
fovCircle.Thickness = 1
fovCircle.Radius = FOV
fovCircle.Filled = false
fovCircle.Visible = true

RunService.RenderStepped:Connect(function()
    fovCircle.Position = UserInputService:GetMouseLocation()
end)

-- ESP
local espObjects = {}

local function clearESP()
    for _, v in pairs(espObjects) do
        if v.Box then v.Box:Remove() end
    end
    espObjects = {}
end

local function createESP(player)
    if player == LocalPlayer then return end
    if TeamCheck and player.Team == LocalPlayer.Team then return end

    local box = Drawing.new("Square")
    box.Color = Color3.fromRGB(255, 0, 0)
    box.Thickness = 1
    box.Filled = false

    espObjects[player] = {
        Box = box,
        Player = player
    }
end

local function updateESP()
    for _, v in pairs(Players:GetPlayers()) do
        if not espObjects[v] and v.Character and v.Character:FindFirstChild("HumanoidRootPart") then
            createESP(v)
        end
    end

    for player, data in pairs(espObjects) do
        local hrp = player.Character and player.Character:FindFirstChild("HumanoidRootPart")
        if hrp and Camera:WorldToViewportPoint(hrp.Position) then
            local pos, onScreen = Camera:WorldToViewportPoint(hrp.Position)
            if onScreen then
                data.Box.Visible = true
                data.Box.Size = Vector2.new(60, 80)
                data.Box.Position = Vector2.new(pos.X - 30, pos.Y - 40)
            else
                data.Box.Visible = false
            end
        else
            data.Box.Visible = false
        end
    end
end

-- AIMBOT
local function getClosestPlayer()
    local closest = nil
    local shortest = math.huge
    for _, v in pairs(Players:GetPlayers()) do
        if v ~= LocalPlayer and v.Character and v.Character:FindFirstChild(AimPart) then
            if not TeamCheck or v.Team ~= LocalPlayer.Team then
                local pos, onScreen = Camera:WorldToViewportPoint(v.Character[AimPart].Position)
                if onScreen then
                    local dist = (Vector2.new(pos.X, pos.Y) - UserInputService:GetMouseLocation()).Magnitude
                    if dist < shortest and dist <= FOV then
                        shortest = dist
                        closest = v
                    end
                end
            end
        end
    end
    return closest
end

RunService.RenderStepped:Connect(function()
    if ESPEnabled then
        updateESP()
    else
        clearESP()
    end

    if AimbotEnabled then
        local target = getClosestPlayer()
        if target and target.Character and target.Character:FindFirstChild(AimPart) then
            local aimPos = Camera:WorldToViewportPoint(target.Character[AimPart].Position)
            mousemoverel((aimPos.X - UserInputService:GetMouseLocation().X), (aimPos.Y - UserInputService:GetMouseLocation().Y))
        end
    end
end)

-- BOTÕES
createButton("Ativar ESP", function()
    ESPEnabled = not ESPEnabled
    return ESPEnabled
end)

createButton("Ativar Aimbot", function()
    AimbotEnabled = not AimbotEnabled
    return AimbotEnabled
end)

createButton("Aumentar FOV", function()
    FOV = FOV + 10
    fovCircle.Radius = FOV
    return false
end)

createButton("Diminuir FOV", function()
    FOV = math.max(10, FOV - 10)
    fovCircle.Radius = FOV
    return false
end)

-- CRÉDITOS
local credit = Instance.new("TextLabel", contentHolder)
credit.Size = UDim2.new(1, 0, 0, 30)
credit.Position = UDim2.new(0, 0, 1, -30)
credit.Text = "By Mccria32"
credit.TextColor3 = Color3.fromRGB(255, 0, 0)
credit.BackgroundTransparency = 1
credit.TextScaled = true
